# 管理觉察测评报告生成系统

一个功能完整的测评报告生成系统，支持Excel数据上传、配置管理、报告预览和多格式导出。

## 🆕 最新版本 v1.1.0

### ✨ 新增功能
- **批量导出功能**：一键导出所有报告为ZIP压缩包（支持HTML/PNG/JPG）
- **日期智能识别**：自动识别Excel日期序列号并转换为标准格式
- **图片导出优化**：使用html-to-image引擎，样式100%还原
- **Banner优化**：只显示日期，界面更简洁

详细更新内容请查看 [更新日志.md](./更新日志.md)

## 功能特性

### 1. 数据上传模块
- 支持拖拽上传Excel文件
- 自动解析和验证数据格式
- 批量处理多条测评数据

### 2. 配置管理模块
支持5个配置Tab：
- **基础配置**：Banner图、Logo图上传
- **阅读说明**：3条原则文字编辑
- **类型概述**：8种管理类型定义编辑
- **详细分析**：8个管理类型的完整配置
  - 标题、引语、头像
  - 优势初衷、典型行为、潜在风险、发展建议
- **附录配置**：版权文字、二维码上传

### 3. 报告预览模块
- **胜任力得分双环图**：外环（想明白、讲清楚、执行到位）+ 内环（管自己、管业务、管团队）
  - 根据分数排名动态调整扇形粗细
  - 精美的渐变色设计
- **八种管理类型得分条形图**：按分数降序排列
- **完整报告**：与sample样式一致的专业报告

### 4. 导出功能
- **HTML导出**：生成独立的HTML文件
- **PNG导出**：高清长图，适合分享
- **JPG导出**：压缩格式，文件更小
- **🆕 批量导出**：一键导出所有报告为ZIP压缩包
  - 批量导出HTML（速度快）
  - 批量导出PNG（高清图片）
  - 批量导出JPG（文件小）
  - 实时显示导出进度

## Excel数据格式

Excel文件需包含以下字段：

| 字段 | 说明 |
|------|------|
| 姓名 | 测评人姓名 |
| 日期 | 测评日期 |
| 想明白 | 胜任力分数 (0-100) |
| 讲清楚 | 胜任力分数 (0-100) |
| 执行到位 | 胜任力分数 (0-100) |
| 管自己 | 管理维度分数 (0-100) |
| 管业务 | 管理维度分数 (0-100) |
| 管团队 | 管理维度分数 (0-100) |
| 劳模型 | 管理类型分数 (0-100) |
| 好人型 | 管理类型分数 (0-100) |
| 严师型 | 管理类型分数 (0-100) |
| 遥控型 | 管理类型分数 (0-100) |
| 隐身型 | 管理类型分数 (0-100) |
| 黄牛型 | 管理类型分数 (0-100) |
| 军师型 | 管理类型分数 (0-100) |
| 内敛型 | 管理类型分数 (0-100) |

## 技术栈

- **前端框架**: React 18 + TypeScript
- **UI组件库**: Ant Design 5
- **图表库**: Chart.js (条形图) + 自定义SVG (双环图)
- **Excel解析**: SheetJS (xlsx)
- **图片导出**: html-to-image (高质量图片渲染)
- **文件处理**: JSZip (批量导出) + FileSaver.js
- **构建工具**: Vite

## 快速开始

### 安装依赖
```bash
npm install
```

### 启动开发服务器
```bash
npm run dev
```

访问 http://localhost:3000

### 构建生产版本
```bash
npm run build
```

### 预览生产版本
```bash
npm run preview
```

## 使用流程

1. **上传数据**
   - 点击"数据上传"按钮
   - 选择Excel文件上传
   - 系统自动解析并验证数据

2. **配置管理**（可选）
   - 点击"配置管理"按钮
   - 在各个Tab中编辑配置
   - 支持上传自定义图片

3. **预览报告**
   - 点击"报告预览"按钮
   - 在下拉框中选择要查看的报告
   - 实时预览报告效果

4. **导出报告**
   - **单个导出**：点击"导出HTML/PNG/JPG"按钮
   - **🆕 批量导出**（多条数据时显示）：
     - 点击"批量导出HTML/PNG/JPG"按钮
     - 等待处理完成（显示实时进度）
     - 下载ZIP压缩包
     - 解压获得所有报告

## 核心算法

### 双环图渲染逻辑
1. 根据分数对数据进行排序
2. 计算排名（rank: 1, 2, 3）
3. 分配粗细（thickness: 30, 20, 10）
4. 根据分数动态计算扇形角度
5. 绘制SVG路径并添加标签

### 主类型判定
- 取8种管理类型中分数最高的作为主类型
- 从配置中获取对应的详细分析内容
- 渲染到报告中

## 项目结构

```
src/
├── components/          # React组件
│   ├── ConfigManager.tsx   # 配置管理
│   ├── DoubleRingChart.tsx # 双环图
│   ├── ReportPreview.tsx   # 报告预览
│   └── ReportPreview.css   # 报告样式
├── config/              # 配置文件
│   └── managementTypes.ts  # 8种管理类型配置
├── types/               # TypeScript类型定义
│   └── index.ts
├── utils/               # 工具函数
│   ├── excelParser.ts      # Excel解析
│   ├── dataProcessor.ts    # 数据处理
│   └── exportUtils.ts      # 导出功能
├── App.tsx              # 主应用
├── App.css
├── main.tsx             # 入口文件
└── index.css
```

## 8种管理类型

1. **劳模型**："自转"出色，"共转"待提升
2. **好人型**：团队氛围出色，工作结果待提升
3. **严师型**："将心比心"待提升
4. **遥控型**："身先士卒"待提升
5. **隐身型**："以身作则"待提升
6. **黄牛型**："想明白"待提升
7. **军师型**："执行到位"待提升
8. **内敛型**："讲清楚"待提升

每种类型都包含完整的配置：标题、引语、优势初衷、典型行为、潜在风险、发展建议。

## 注意事项

- Excel文件必须包含所有必要字段
- 分数范围必须在0-100之间
- 🆕 日期支持Excel序列号自动转换（如45939 → 2025/10/09）
- 图片文件建议使用PNG格式以保证透明度
- 🆕 批量导出建议单次不超过50份报告
- 批量导出时请勿切换页面，等待处理完成

## 🚀 部署到 Railway

### 快速部署步骤

1. **通过 GitHub 自动部署（推荐）**
   ```bash
   # 推送代码到 GitHub
   git add .
   git commit -m "feat: 准备Railway部署"
   git push origin main
   ```
   
   然后访问 [railway.app](https://railway.app)：
   - 点击 "New Project"
   - 选择 "Deploy from GitHub repo"
   - 选择您的仓库
   - Railway 自动检测配置并部署

2. **通过 Railway CLI**
   ```bash
   # 安装 CLI
   npm install -g @railway/cli
   
   # 登录
   railway login
   
   # 初始化并部署
   railway init
   railway up
   ```

详细部署指南请查看 [DEPLOY.md](./DEPLOY.md)

### 部署后访问

部署成功后，您会获得一个 Railway URL：
```
https://your-project.up.railway.app
```

可以分享此链接给团队成员直接使用！

## License

MIT

